{% extends "base.html" %}
{% block title %}Order List{% endblock %}

{% block content %}  
<h2>Order List</h2>
<div class="container">
    <a href="{% url 'order_new' %}" class="btn btn-green">Add New Order</a>
    <form method="get" class="search-form">
        <div class="form-row">
            <div class="form-col">
                <label for="employee_name">Employee Name:</label>
                <input type="text" id="employee_name" name="employee_name" placeholder="Search by employee name...">
            </div>
            <div class="form-col">
                <label for="order_code">Order Code:</label>
                <input type="text" id="order_code" name="order_code" placeholder="Search by order code...">
            </div>
            <div class="form-col">
                <label for="product_name">Product Name:</label>
                <input type="text" id="product_name" name="product_name" placeholder="Search by product name...">
            </div>
        </div>
        <div class="form-row">
            <div class="form-col">
                <label for="date_from">Date From:</label>
                <input type="date" id="date_from" name="date_from">
            </div>
            <div class="form-col">
                <label for="date_to">Date To:</label>
                <input type="date" id="date_to" name="date_to">
            </div>
            <div class="form-col">
                <label for="supplier_name">Supplier Name:</label>
                <input type="text" id="supplier_name" name="supplier_name" placeholder="Search by supplier name...">
            </div>
        </div>
        <button type="submit" class="search-button" style="position:relative; left:5px">Search</button>
    </form>
</div>



<table>
    <thead>
        <tr>
            <th>Order Number</th>
            <th>Project Name</th>
            <th>Request Date</th>
            <th>Supply Date</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
        {% for order in orders %}
        <tr>
            <td>{{ forloop.counter|stringformat:"03d" }}</td>
            <td>{{ order.project_name }}</td>
            <td>{{ order.request_date }}</td>
            <td>{{ order.supply_date }}</td>
            <td>{{ order.get_status_display }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>




<style>
    .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    .modal-content {
        background-color: #fefefe;
        margin: 15% auto; /* 15% from the top and centered */
        padding: 20px;
        border: 1px solid #888;
        width: 80%; /* Could be more or less, depending on screen size */
    }

    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }
</style>

<script>
function showModal(orderId) {
    var modal = document.getElementById('deleteModal');
    var span = document.getElementsByClassName("close")[0];
    var form = document.getElementById('deleteForm');

    document.getElementById('order-id').textContent = orderId;
    form.action = '{% url "order_delete" id='0' %}'.replace('0', orderId);

    modal.style.display = "block";

    span.onclick = function() {
        modal.style.display = "none";
    }

    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
}
</script>

<script>
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('disapproved') === 'true') {
            // Show modal logic here
            alert('Order has been disapproved by {{ user.username }}');
        }
    }
</script>

{% endblock %}